<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">

    <title>Contact Pages!</title>
  </head>
  <body>
    
    <div class="container">
        
        <div class="my-4">

            <h1 class="d-block mx-3">Create Contact</h1>
       <form action="/contacts" method="POST" class="d-flex" id="my-form">
        
        <div class="form-group mx-3">
            <input type="text" name="name" class="form-control" required placeholder="Name">
        </div>
        <div class="form-group mx-3">
            <input type="email" name="email" class="form-control" required placeholder="Email">
        </div>
        <div class="form-group mx-3">
            <input type="text" name="phone" class="form-control" required placeholder="Phone">
        </div>
        <input type="text" name="id" hidden>
        <input type="submit" class="btn btn-primary" value="submit">
       </form>

        </div>

        <div class="">
          <h1>All Contact(s)</h1>
          
          <table class="table">
            <thead>
              <tr>
                <th scope="col">#</th>
                <th scope="col">Name</th>
                <th scope="col">Email</th>
                <th scope="col">Phone</th>
                <th scope="col">Action</th>
              </tr>
            </thead>
            <tbody>
               <% i=1; %>
                <% for(let con of contact){ %>
                    <tr>
                        <td><%= i++ %></td>
                        <td><%= con.name %></td>
                        <td><%= con.email %></td>
                        <td><%= con.phone %></td>
                        <td>
                            <button class="btn btn-info edit-btn"
                            data-name="<%= con.name %>"
                            data-email="<%= con.email %>"
                            data-phone="<%= con.phone %>"
                            data-id="<%= con._id %>"
                            >Edit</button>
                            <a href="/contacts/delete/<%= con._id %>" class="btn btn-danger">Delete</a>
                        </td>
                    </tr>
                  <% } %>

            </tbody>
          </table>

        </div>

    </div>

    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js" integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous"></script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.6.0/dist/umd/popper.min.js" integrity="sha384-KsvD1yqQ1/1+IA7gi3P0tyJcT3vR+NdBTt13hSJ2lnve8agRGXTTyNaBYmCR/Nwi" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.min.js" integrity="sha384-nsg8ua9HAw1y0W1btsyWgBklPnCUAFLuTMS2G72MMONqmOymq585AcH49TLBQObG" crossorigin="anonymous"></script>
   
    <script>
        window.onload=function(){
          let editBtn=document.getElementsByClassName('edit-btn')
          let form=document.getElementById('my-form');
          ;[...editBtn].forEach(btn=>{
              btn.addEventListener('click', function(e){
                  console.log(e.target.dataset)
                  const { name, email, phone, id}=e.target.dataset
                  form[0].value=name;
                  form[1].value=email;
                  form[2].value=phone;
                  form[3].value=id;
                  form[4].value='Update';
              })
          })
        }
    </script>
  </body>
</html>